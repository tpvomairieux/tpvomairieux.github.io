<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Phu Vo">
<meta name="dcterms.date" content="2025-11-12">
<meta name="description" content="The Ethical Dilemmas of Personal Data Scraping">

<title>Dating Data – Phu Vo</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-fd053a38988e21bb3d3b0b617a2084cf.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Phu Vo</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-data-visualization" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Data Visualization</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-data-visualization">    
        <li>
    <a class="dropdown-item" href="./dveu.html">
 <span class="dropdown-text">Eurovision Song Contest</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dvspot.html">
 <span class="dropdown-text">Spotify</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./Dickinson.html"> 
<span class="menu-text">Full Text Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./AnimalCrossing.html"> 
<span class="menu-text">Permutation Testing</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./project4.html" aria-current="page"> 
<span class="menu-text">Ethics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./project5.html"> 
<span class="menu-text">SQL</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./p1.html"> 
<span class="menu-text">Practice</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction-and-scenario" id="toc-introduction-and-scenario" class="nav-link active" data-scroll-target="#introduction-and-scenario">Introduction and Scenario</a></li>
  <li><a href="#permission-and-consent-structure-q1" id="toc-permission-and-consent-structure-q1" class="nav-link" data-scroll-target="#permission-and-consent-structure-q1">Permission and Consent Structure (Q1)</a></li>
  <li><a href="#data-collection-and-ethics-q3" id="toc-data-collection-and-ethics-q3" class="nav-link" data-scroll-target="#data-collection-and-ethics-q3">Data Collection and Ethics (Q3)</a></li>
  <li><a href="#identifiable-data-and-anonymization-q5" id="toc-identifiable-data-and-anonymization-q5" class="nav-link" data-scroll-target="#identifiable-data-and-anonymization-q5">Identifiable Data and Anonymization (Q5)</a></li>
  <li><a href="#unintended-uses-q8" id="toc-unintended-uses-q8" class="nav-link" data-scroll-target="#unintended-uses-q8">Unintended Uses (Q8)</a></li>
  <li><a href="#why-care" id="toc-why-care" class="nav-link" data-scroll-target="#why-care">Why Care?</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Dating Data</h1>
</div>

<div>
  <div class="description">
    <p>The Ethical Dilemmas of Personal Data Scraping</p>
  </div>
</div>


<div class="quarto-title-meta column-page-left">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Phu Vo </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 12, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction-and-scenario" class="level2">
<h2 class="anchored" data-anchor-id="introduction-and-scenario">Introduction and Scenario</h2>
<p>In 2015, data scientists Albert Y. Kim and Adriana Escobedo-Land released a dataset of 59,946 collected San Francisco OkCupid users from a period in the 2010s. Their goal was to provide a real example of a complex datasetfor undergraduat students in introductory statistics and data-science classes to practice modeling, visualization, and text analysis in R (Kim &amp; Escobedo-Land, 2015). The dataset included demographic variables, such as age, gender, height, religion, and lifestyle habits, but also personal responses to 10 open-ended essay questions.</p>
<p>However, in 2021, Tiffany Xiao and Yifan Ma published a letter to the Journal of Statistics and Data Science Education named “A Call for Review of ‘OkCupid Data for Introductory Statistics and Data Science Courses’ by Albert Y. Kim and Adriana Escobedo-Land.” They argued that the dataset violated key ethical principles surrounding consent and personal identification (Xiao &amp; Ma, 2021). Although the researchers had legal permission from OK Cupid to use the data, users were not explicitly informed that their profiles could be made public for the use of research or classroom use– especially for non-users of the dating app. The tension between public data and privacy in life is an example of one of the largest ethical dilemmas in modern data science: just because something is public and accessible, does it mean we can freely use it without restriction? The issue echoes contemporary controversies like the latest Tik Tok trend, Cheater Buster, which from what I’ve gathered, is an AI site that scrapes names, phone numbers, and faces from dating apps and social media profiles to detect potential cheating/infidelity– which raises similar concerns about digital surveillance and privacy. Cheater Buster is basically a service that allows anyone to search dating platforms such as Tinder or Hinge by entering a name or phone number, or uploading an image to the site, to check whether or not a partner has an active profile. The tool scrapes personal data and photos from dating apps to flag “cheaters,” even though the individuals searched have not consented to being monitored in this way, raising similar concerns about digital surveillance and privacy.</p>
<p>Today, by request of the original authors (Kim and Escobedo-Land), the publication has been corrected to further remove potential identifiers of the OkCupid users whose data was used as examples or scraped, while retaining its educational use. Ages were randomized, the data file was renamed, and the open-ended user responses were shuffled around in the 2021 revised edition (Kim &amp; Escobedo-Land, 2021).</p>
</section>
<section id="permission-and-consent-structure-q1" class="level2">
<h2 class="anchored" data-anchor-id="permission-and-consent-structure-q1">Permission and Consent Structure (Q1)</h2>
<p>Although Kim and Escobedo-Land received explicit permission from OkCupid leadership to use a scraped dataset– permission that technically satisfied the company-to-researcher requirement (Kim &amp; Escobedo-Land, 2015)– this does not resolve the central ethical issue: individual users never consented to having their personal essays, profile details, or demographic information repurposed for public datasets. Users reasonably expect their profiles to be viewed only within the dating platform, not downloaded, scraped, or redistributed for research or teaching. Basically, obtaining corporate permission satisfied legal requirements, but it bypassed the consent of the people whose intimate data was being studied, shared, and later publicly distributed.</p>
<p>OkCupid’s Terms of Use reinforce this expectation by prohibiting the use of “any robot [or] crawler” to extract data (Sec. 2c) and by stating that Member Content “belongs to the user” and cannot be copied or redistributed outside the service (Sec. 3b). These clauses indicate that automated scraping directly contradicts what users agreed to (OkCupid, 2025). Thus, even with corporate permission, users’ actual consent was never obtained.</p>
<p>Xiao and Ma argue that this gap between platform approval and user awareness reflects a broader problem: outdated U.S. data laws make legality an unreliable guide for ethical practice (Xiao &amp; Ma, 2021). They emphasize that variables such as essays, demographics, and temporal or geographic markers remain identifiable and require stronger anonymization and more controlled access. The same concerns apply to modern systems like Cheater Buster, which scrape faces and personal details without user consent despite platform prohibitions. Across both cases, the underlying issue is the absence of meaningful, informed permission for intimate data to be used beyond its intended dating context.</p>
</section>
<section id="data-collection-and-ethics-q3" class="level2">
<h2 class="anchored" data-anchor-id="data-collection-and-ethics-q3">Data Collection and Ethics (Q3)</h2>
<p>Kim and Escobedo-Land provide a clear description of how the OK Cupid dataset was collected (Kim &amp; Escobedo-Land, 2015). The data were obtained by scraping public-facing OK Cupid profiles using a Python script. The authors explain that the dataset consists of “the public profiles of 59,946 OkCupid users who were living within 25 miles of San Francisco, had active profiles during a period in the 2010s, were online in the previous year, and had at least one picture in their profile.” They further note that “any non-publicly facing information such as messaging was not accessible,” confirming that only content visible to any OK Cupid user– or anyone browsing publicly viewable portions of the platform– was collected. The scrape occurred over a four-day window and captured typical demographic information and lifestyle habits. Random noise was added to the age variable as a basic anonymization step.</p>
<p>Whether the observations were collected ethically is more complex. Legally, the profiles were publicly viewable, and OK Cupid gave the authors permission to use the data. Ethically, however, users likely did not expect their dating profiles to be harvested, stored offline, and distributed publicly for teaching or research. Xiao and Ma argue that even when scraping is technically permissible, datasets like this require stronger anonymization because public visibility does not equal informed consent– especially given the intimate nature of dating-profile content (Xiao &amp; Ma, 2021). Their concern is not that the authors acted maliciously, but that relying solely on “public availability” overlooks the privacy expectations of the people represented.</p>
</section>
<section id="identifiable-data-and-anonymization-q5" class="level2">
<h2 class="anchored" data-anchor-id="identifiable-data-and-anonymization-q5">Identifiable Data and Anonymization (Q5)</h2>
<p>The OK Cupid dataset is only partially anonymized, and several components remained potentially identifiable even after initial cleaning. Kim and Escobedo-Land removed usernames and added random noise to the age variable, but they retained free-text profile essays and a number of demographic and lifestyle variables (Kim &amp; Escobedo-Land, 2015) . Xiao and Ma specifically note that the dataset “was found to contain identifiable information” prior to correction, and they highlight several categories of variables that increase the risk of identification: temporal information, geographic information, and rich textual content (Xiao &amp; Ma, 2021).</p>
<p>Some of the data is identifiable because free-response essays can contain unique phrases, personal details, or references that users voluntarily included in their profiles. Even without explicit names, writing style and self-descriptions can function as identifiers, especially when matched against still-public OK Cupid profiles. Xiao and Ma argue that certain variables– such as the time of data collection– had “identification power disproportionate to their value for research,” meaning they made re-identification easier without improving the dataset’s pedagogical usefulness (Xiao &amp; Ma, 2021).</p>
<p>Other variables, such as ethnicity, height, specific lifestyle combinations, and narrow geographic radius (within 25 miles of San Francisco), further increase the potential for triangulation with public profiles. Although these variables are not uniquely identifying on their own, together they create detailed user signatures that could allow motivated actors to match individuals to their online profiles.</p>
<p>As for whether the dataset is sufficiently anonymized or old enough to be free of ethical concerns, Xiao and Ma’s letter suggests the answer is no (Xiao &amp; Ma, 2021). They emphasize that outdated data-privacy laws cannot be relied upon to protect user identity and that additional anonymization steps were needed before public release. Being older does not eliminate risk: user essays and profile characteristics remain linkable if the original OK Cupid profiles– or archived versions– are still accessible.</p>
<p>Anonymity is not guaranteed in this dataset. Rich text data, combined with demographic variables and temporal markers, makes complete de-identification effectively impossible. Xiao and Ma recommend alternative approaches such as removing certain variables altogether or distributing the data through secure channels instead of posting it publicly, underscoring that meaningful anonymity could not be assured with the dataset in its original form (Xiao &amp; Ma, 2021).</p>
</section>
<section id="unintended-uses-q8" class="level2">
<h2 class="anchored" data-anchor-id="unintended-uses-q8">Unintended Uses (Q8)</h2>
<p>There is evidence that OK Cupid data has been used in ways far beyond what Kim and Escobedo-Land originally intended (Kim &amp; Escobedo-Land, 2015). Their stated purpose was explicitly pedagogical: the dataset was created for instructional use in introductory statistics and data-science courses. However, Xiao and Ma contextualize the dataset within a broader pattern of unintended and controversial reuse of OK Cupid data over the past decade, citing two specific incidents (Xiao &amp; Ma, 2021).</p>
<p>First, the 2014 case where an individual scraped OK Cupid profiles to analyze and optimize his dating strategy. The legality of his scraping was debated, raising questions about potential violations of the Computer Fraud and Abuse Act (Penenberg, 2014).</p>
<p>Second, the 2016 incident where researchers scraped and publicly posted data from 70,000 OK Cupid users without anonymization, causing widespread public outcry (Hackett, 2016). The researchers argued that their actions were legal because the profiles were publicly visible, but their release was widely condemned as an invasion of privacy.</p>
<p>Xiao and Ma use these examples to show that once dating-profile data is publicly released or publicly accessible, it is highly susceptible to re-purposing beyond its original educational context, regardless of intent (Xiao &amp; Ma, 2021). Their letter makes it clear that relying on legality or “public availability” does not protect individuals from later misuse. Although Kim and Escobedo-Land did not encourage disruptive reuse, publicly releasing the dataset created the possibility of the same kind of function creep that occurred in 2014 and 2016. This includes the potential for re-identification, surveillance, analytical uses unrelated to teaching, or aggregation with other datasets. Xiao and Ma’s recommendation to remove certain variables or distribute the data through secure channels reflects their concern that once data is public, its uses can no longer be controlled. In this way, the OK Cupid dataset fits a broader pattern– dating-app data often ends up being used in ways far beyond what data subjects, or even researchers, originally envisioned.</p>
</section>
<section id="why-care" class="level2">
<h2 class="anchored" data-anchor-id="why-care">Why Care?</h2>
<p>The issues raised in the OkCupid dataset and in modern scraping tools like Cheater Buster matter because they reveal a structural imbalance in who benefits from data extraction and who bears the risks. Researchers and developers gain access to detailed datasets that can be used to train AI, improve products, or for academic purposes. However, the users whose data makes this possible does not benefit, and often doesn’t even have the knowledge that their information, sometimes intimate, has been re-purposed, or shared around. This could cause reputational harm (imagine a fake tinder profile someone made of you and your insecure S.O. found you on Cheater Buster), or the loss of control over personal narratives that they originally shared only for dating purposes.</p>
<p>Like the OkCupid scrape, Cheater Buster reframes dating as a public data source, not a personal space. The service presents itself as a tool for honesty or relationship protection, yet it enables surveillance of unsuspecting individuals using data they never agreed to share outside the app. Those most harmed tend to be individuals who already experience disproportionate risks online: LGBTQ+ users, people of color, and anyone who shares sensitive information in essays or photographs. These groups may be more easily identifiable due to facial features, mannerisms, or writing style, and the public release of such data heightens the risk of doxxing, harassment, or unwanted exposure. Meanwhile, the ones who scrape or redistribute their data face little to no consequences, in part because outdated U.S. privacy laws do not clearly regulate the repurposing of publicly viewable online information (Xiao &amp; Ma, 2021).</p>
<p>The motivations behind such ethical violations often combine multiple forces. In the OkCupid case, the release was not driven by direct profit, but by academic convenience and the desire for a compelling dataset. In contrast, tools like Cheater Buster operate within an economy of surveillance– users can stalk others under the guise of transparency, accountability, or relationship protection. Whether for research credibility, product differentiation, or monetizing suspicion, these systems leverage personal data in ways that prioritize commercial benefit over individual privacy. Platforms and data collectors possess the technological and legal capacity to extract and repurpose user data, while individuals have limited awareness and even less control. Ensuring meaningful consent, limiting identifiability, and preventing unintended uses are essential steps toward restoring that balance and protecting demographics most affected by these decisions.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p>Hackett, R. (2016). Researchers caused an uproar by publishing data from 70,000 okcupid users.&nbsp;<em>Fortune</em>.</p>
<p>Kim, A. Y., &amp; Escobedo-Land, A. (2015). OkCupid data for introductory statistics and data science courses.&nbsp;<em>Journal of Statistics Education</em>,&nbsp;<em>23</em>(2).</p>
<p>Penenberg, A. L. (2014). Did the mathematician who hacked OkCupid violate federal computer laws?.&nbsp;<em>Pando Daily. URL: http://pando. com/2014/01/22/did-the-mathematician-who-hacked-okcupid-violate-federalcomputer-laws/.</em></p>
<p>Terms of Service. (2025). Retrieved November 11, 2025, from OkCupid, OkCupid Terms &amp; Conditions Website, https://okcupid-app.zendesk.com/hc/en-us/articles/23941864418203-Terms-Conditions.</p>
<p>Xiao, T., &amp; Ma, Y. (2021). A letter to the Journal of Statistics and Data Science Education– a call for review of “OkCupid data for introductory statistics and data science courses” by Albert Y. Kim and Adriana Escobedo-Land.&nbsp;<em>Journal of Statistics and Data Science Education</em>,&nbsp;<em>29</em>(2), 214-215.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>